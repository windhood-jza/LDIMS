import{an as E,d as I,r as v,l as _,e as N,j as m,ao as R,f as s,g as t,$ as S,h as p,i as U,k as b,ap as C,E as f,_ as L}from"./index-DAb5ELNo.js";const w=E.create({baseURL:"/api/v1/auth",timeout:1e4});w.interceptors.response.use(a=>{var l;return a.data&&a.data.code===200?a.data:Promise.reject(new Error(((l=a.data)==null?void 0:l.message)||"请求失败"))},a=>{var r,n,u;console.error("Auth API 请求错误:",(r=a.response)==null?void 0:r.status,a.message);const l=((u=(n=a.response)==null?void 0:n.data)==null?void 0:u.message)||a.message||"登录请求失败";return Promise.reject(new Error(l))});const M=async a=>w.post("/login",a),j={class:"login-page"},z={class:"login-container"},A={class:"login-form-container"},B=I({__name:"LoginView",setup(a){const l=C(),r=v(),n=v(!1),u=v(!1),i=_({username:"",password:""}),V=_({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}),y=async()=>{if(r.value)try{await r.value.validate(),n.value=!0;try{const o=await M(i);if(o&&o.data){const{token:e,user:d}=o.data;e&&d?(localStorage.setItem("authToken",e),localStorage.setItem("userInfo",JSON.stringify(d)),console.log("登录成功，Token:",e),console.log("用户信息:",d),f.success(o.message||"登录成功"),l.push("/dashboard")):(console.error("登录响应格式错误: token 或 user 不存在"),f.error("登录响应格式错误"))}else console.error("登录响应格式错误: response 或 response.data 不存在"),f.error("登录响应格式错误")}catch(o){console.error("登录失败:",o),f.error(o.message||"登录失败，请稍后重试")}finally{n.value=!1}}catch(o){console.log("表单验证失败:",o)}};return(o,e)=>{const d=p("el-input"),g=p("el-form-item"),h=p("el-checkbox"),k=p("el-button"),x=p("el-form");return U(),N("div",j,[m("div",z,[e[6]||(e[6]=R('<div class="login-banner" data-v-4b40ca41><div class="banner-content" data-v-4b40ca41><h1 class="main-title" data-v-4b40ca41><span class="org-name" data-v-4b40ca41>技术中心融合业务部</span><span class="system-name" data-v-4b40ca41>文档管理系统</span></h1><p data-v-4b40ca41>高效的文档管理平台，助力台信息化建设。提供文档录入、存储、查询和统计分析等全方位功能，让文档管理更简单。</p></div></div>',1)),m("div",A,[s(x,{ref_key:"loginFormRef",ref:r,model:i,rules:V,"label-position":"top",class:"login-form",onSubmit:S(y,["prevent"])},{default:t(()=>[e[5]||(e[5]=m("div",{class:"login-header"},[m("h2",null,"欢迎使用"),m("p",null,"请登录您的账号")],-1)),s(g,{label:"用户名",prop:"username"},{default:t(()=>[s(d,{modelValue:i.username,"onUpdate:modelValue":e[0]||(e[0]=c=>i.username=c),placeholder:"请输入用户名",size:"large"},null,8,["modelValue"])]),_:1}),s(g,{label:"密码",prop:"password"},{default:t(()=>[s(d,{type:"password",modelValue:i.password,"onUpdate:modelValue":e[1]||(e[1]=c=>i.password=c),placeholder:"请输入密码","show-password":"",size:"large"},null,8,["modelValue"])]),_:1}),s(g,null,{default:t(()=>[s(h,{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=c=>u.value=c)},{default:t(()=>e[3]||(e[3]=[b("记住密码")])),_:1},8,["modelValue"])]),_:1}),s(g,null,{default:t(()=>[s(k,{type:"primary","native-type":"submit",loading:n.value,class:"login-btn",size:"large"},{default:t(()=>e[4]||(e[4]=[b(" 登 录 ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])])])])}}}),P=L(B,[["__scopeId","data-v-4b40ca41"]]);export{P as default};
