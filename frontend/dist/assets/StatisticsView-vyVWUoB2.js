import{w as D,d as z,r as i,o as M,e as O,j as l,f as s,g as r,h as d,E as g,i as Y,k as _,_ as B}from"./index-DAb5ELNo.js";import{bx as $,ex as C,eu as E,et as W,ev as I,er as N,eq as q,ew as A,es as F}from"./install-BHxGzirc.js";const X=u=>D.get("/statistics/by-department",{params:u}),j=u=>D.get("/statistics/by-doc-type",{params:u}),U={class:"statistics-container"},G={class:"filter-container"},H={class:"date-range-picker"},J={class:"charts-container"},K=z({__name:"StatisticsView",setup(u){$([E,W,I,N,q,A,F]);const f=i(null),v=i(null),c=i(null),p=i(null),o=i(null),h=i(!1),m=async()=>{try{h.value=!0;const e=o.value?{startDate:o.value[0],endDate:o.value[1]}:void 0,t=await X(e);S(t)}catch(e){console.error("获取部门统计数据失败:",e),g.error("获取部门统计数据失败")}finally{h.value=!1}},w=async()=>{try{h.value=!0;const e=o.value?{startDate:o.value[0],endDate:o.value[1]}:void 0,t=await j(e);x(t)}catch(e){console.error("获取文档类型统计数据失败:",e),g.error("获取文档类型统计数据失败")}finally{h.value=!1}},S=e=>{if(!f.value)return;c.value||(c.value=C(f.value));const t={title:{text:"文档按部门分布",left:"center",subtext:e.length>0?`总数量: ${e.reduce((a,n)=>a+n.value,0)}`:""},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{type:"scroll",orient:"vertical",right:10,top:40,bottom:20,selectedMode:!0},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!0,title:"查看数据"},saveAsImage:{show:!0,title:"保存为图片"},restore:{show:!0,title:"还原"}}},series:[{name:"部门文档数",type:"pie",radius:["35%","70%"],center:["40%","55%"],roseType:"radius",itemStyle:{borderRadius:8,borderColor:"#fff",borderWidth:2},label:{show:!0,position:"outside",formatter:"{b}: {c} ({d}%)",fontSize:12,alignTo:"labelLine",overflow:"break",color:"#444"},emphasis:{label:{show:!0,fontSize:14,fontWeight:"bold",color:"#222"},itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},labelLine:{show:!0,length:15,length2:10,smooth:!0},labelLayout:{hideOverlap:!0},data:e}]};c.value.setOption(t),window.addEventListener("resize",()=>{var a;(a=c.value)==null||a.resize()})},x=e=>{if(!v.value)return;p.value||(p.value=C(v.value));const t={title:{text:"文档按类型分布",left:"center",subtext:e.length>0?`总数量: ${e.reduce((a,n)=>a+n.value,0)}`:""},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{type:"scroll",orient:"vertical",right:10,top:40,bottom:20,selectedMode:!0},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!0,title:"查看数据"},saveAsImage:{show:!0,title:"保存为图片"},restore:{show:!0,title:"还原"}}},series:[{name:"类型文档数",type:"pie",radius:["35%","70%"],center:["40%","55%"],roseType:"radius",itemStyle:{borderRadius:8,borderColor:"#fff",borderWidth:2},label:{show:!0,position:"outside",formatter:"{b}: {c} ({d}%)",fontSize:12,alignTo:"labelLine",overflow:"break",color:"#444"},emphasis:{label:{show:!0,fontSize:14,fontWeight:"bold",color:"#222"},itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},labelLine:{show:!0,length:15,length2:10,smooth:!0},labelLayout:{hideOverlap:!0},data:e}]};p.value.setOption(t),window.addEventListener("resize",()=>{var a;(a=p.value)==null||a.resize()})},k=e=>{o.value=e},L=()=>{m(),w()},T=()=>{o.value=null,m(),w()};return M(()=>{m(),w()}),(e,t)=>{const a=d("el-date-picker"),n=d("el-button"),b=d("el-card"),y=d("el-col"),V=d("el-row");return Y(),O("div",U,[l("div",G,[s(b,{shadow:"hover"},{default:r(()=>[l("div",H,[s(a,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=R=>o.value=R),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:k},null,8,["modelValue"]),s(n,{type:"primary",onClick:L},{default:r(()=>t[1]||(t[1]=[_("应用筛选")])),_:1}),s(n,{onClick:T},{default:r(()=>t[2]||(t[2]=[_("重置")])),_:1})])]),_:1})]),l("div",J,[s(V,{gutter:20},{default:r(()=>[s(y,{span:12},{default:r(()=>[s(b,{shadow:"hover",class:"chart-card"},{header:r(()=>t[3]||(t[3]=[l("div",{class:"card-header"},[l("span",null,"按部门统计")],-1)])),default:r(()=>[l("div",{ref_key:"departmentChartRef",ref:f,class:"chart"},null,512)]),_:1})]),_:1}),s(y,{span:12},{default:r(()=>[s(b,{shadow:"hover",class:"chart-card"},{header:r(()=>t[4]||(t[4]=[l("div",{class:"card-header"},[l("span",null,"按文档类型统计")],-1)])),default:r(()=>[l("div",{ref_key:"docTypeChartRef",ref:v,class:"chart"},null,512)]),_:1})]),_:1})]),_:1})])])}}}),Z=B(K,[["__scopeId","data-v-94865534"]]);export{Z as default};
